dist: xenial
language: python
python:
- '3.6'
cache:
  pip: true
env:
- DEPLOY_PYPI="true"
deploy:
  matrix:
  - provider: releases
    api_key: "$GITHUB_TOKEN"
    file_glob: true
    file: "$TRAVIS_BUILD_DIR/bundles/*"
    skip_cleanup: true
    overwrite: true
    on:
      tags: true
  - provider: pypi
    user: 2bndy5
    password:
      secure: Q/HdqiQDJ5eMMtL+717MpyiPZQpBaa1qRRGiWRE8c9f1Q7Fh345atHjrDUbMU7tl8GJHvBpf239vcrYB6W9/3qumRmZWv2ZeI0KZVTQSUL4289vAbdp3rbUFIFYpV/HVjD8l9P8iwINdB4JS4OIHP9Vd33rQ1+QCKJ2xh1LWYOlGnZL7UqisLtNRO8cv5RDNnH6lcugHSIAzdvJ90otOqlBe43RxQR0T+CZ+vwMyFhWtaYpkHFflZx0GOvSZbz3o13+DWrBd5puFLPj9DqDVHuxjSyZu2nQRN7mC2irre9FDIcOFLFoauGji3NUO591ppoE+++7iBSUNAnaU/aSANL411sF94oWkM0f5oxIyajJB6zX8lJyIPtjP+wRnRJ9+lkxN0JCT+TDF1CJlZ3Mf7Y0ss92voCTD/ce3MasTp4P89ZEUf1ofnAS7q+LDuXtrmu0GWlxIN1OiDikRomIH5Pcvm5WPQeBOJXQaIkjzHlK5T9WqK1giAZtcAkMdshLRxn44hEaph52Vk+T17Py6H5Q0dAeMgA5a2dFLk5s2XwVeV1+4Dv+CGY/z2MbQ5nUyHYCGeWOuTnsaDvRb5yWNGiofM82L14kz7Cu/4PseHQBxijEVNRkZeGm7+dIf4IcvoXfIQ1WURE4DpHJywa3YiPvjj9r/nWPgOF+lYgPz+8A=
    on:
      tags: true
      condition: $DEPLOY_PYPI = "true"
install:
- pip install -r requirements.txt
- pip install circuitpython-build-tools Sphinx sphinx-rtd-theme
- pip install --force-reinstall pylint==1.9.2
script:
- pylint circuitpython_mpu6050.py
- ([[ ! -d "examples" ]] || pylint --disable=missing-docstring,invalid-name,bad-whitespace
  examples/*.py)
- circuitpython-build-bundles --filename_prefix circuitpython-mpu6050 --library_location
  .
- cd docs && sphinx-build -E -W -b html . _build/html && cd ..
