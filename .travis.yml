dist: xenial
language: python
python:
- '3.6'
cache:
  pip: true
env:
- DEPLOY_PYPI="true"
deploy:
  matrix:
  - provider: releases
    api_key: "$GITHUB_TOKEN"
    file_glob: true
    file: "$TRAVIS_BUILD_DIR/bundles/*"
    skip_cleanup: true
    overwrite: true
    on:
      tags: true
  - provider: pypi
    user: 2bndy5
    password:
      secure: "FPYE0GDduBytJ3P9dRsB1vYPUBkMxmaKqB8osj7JS/XQNUendL+Z+sFUxdTRL6IJMaIbNh2AImVS+/Uqq7EMEIRB7j8f7g7+oSwR2DT04NYt7u55DB3FNr9egOcXsKt3BDZuJIb0hS8FWmXpOKgF77nT2U0cmxsVTjEFdUcwcLJVjDYBwjbnHlqeYg7SgnMJ2lV7qH/bzcPcXQ3PoFxMelD2RgQ75C0kJ3Jp9MH/hQOhgo/ZOLbH40pmgXfxc/YRaQoeHcyh1fv9ddfbIuygyv9qguugHqau4rn+y9rDY0H/L+RF8ZvAumVd9w/jMgGGYiYUU8fx8uxyyUCGFiGt1kp8cabgw0Yd5vVQYblstF8nmiCyIQlrgVdC5BJ2ZoUigU+/hvPko0/4QfZqAj2BFPjwjJ63y2bqw+DdhStOiTVkcHFxXpmrSlQSklJcNZZCYfFAaMRYfUjD1SFEwc5VhFMQUGTdMkgV9iDosaq1CmZCJY4xJmRBdCJlgvCoCxvDLhMcVpyI+9uBOMPtiQIRIua7kMkZ3PUZr5vvp+BijjgQz+5f7Ixt43ESshKAJNukR4DIacdwuohtbNV49QdSS2//3jVD+qlmL5ewvmqTM6GWgqivLSFn8SaVFRa6lLfGaL/FKaCrDMXsvCMjgot9mNnjSJdYXpQV2HQCnuMqLpU="
    on:
      tags: true
      condition: $DEPLOY_PYPI = "true"
install:
- pip install -r requirements.txt
- pip install circuitpython-build-tools Sphinx sphinx-rtd-theme
- pip install --force-reinstall pylint==1.9.2
script:
- pylint circuitpython_mpu6050.py
- ([[ ! -d "examples" ]] || pylint --disable=missing-docstring,invalid-name,bad-whitespace
  examples/*.py)
- circuitpython-build-bundles --filename_prefix circuitpython-mpu6050 --library_location
  .
- cd docs && sphinx-build -E -W -b html . _build/html && cd ..
